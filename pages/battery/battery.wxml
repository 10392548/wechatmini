<!--pages/battery/battery.wxml-->
<navigation-bar title="ç”µæ± çŠ¶æ€" back="{{true}}" color="black" background="#FFF"></navigation-bar>
<view class="page">
  <!-- è°ƒè¯•å¼€å…³ï¼ˆå¼€å‘ç”¨ï¼Œä¸Šçº¿å‰åˆ é™¤ï¼‰ -->
  <view class="debug-switch" wx:if="{{isDebug}}">
    <text class="debug-label">è°ƒè¯•æ¨¡å¼</text>
    <switch checked="{{isOnline}}" bindchange="toggleOnline" color="#4CAF50"/>
    <text class="debug-status">{{isOnline ? 'åœ¨çº¿' : 'ç¦»çº¿'}}</text>
  </view>

  <!-- è®¾å¤‡çŠ¶æ€å¡ç‰‡ -->
  <view class="status-card">
    <view class="status-header">
      <view class="status-icon {{isOnline ? 'online' : 'offline'}}">
        <view class="status-dot"></view>
      </view>
      <view class="status-info">
        <text class="status-title">è®¾å¤‡çŠ¶æ€</text>
        <text class="status-value {{isOnline ? 'online' : 'offline'}}">{{isOnline ? 'åœ¨çº¿' : 'ç¦»çº¿'}}</text>
      </view>
    </view>
    <view class="status-footer">
      <text class="last-online">æœ€ååœ¨çº¿: {{lastOnlineTime}}</text>
    </view>
  </view>

  <!-- ç”µæ± ä¸»å¡ç‰‡ - ä»…åœ¨çº¿æ—¶æ˜¾ç¤º -->
  <view class="battery-card {{batteryClass}}" wx:if="{{isOnline}}">
    <view class="battery-visual">
      <!-- ç”µæ± å›¾æ ‡ -->
      <view class="battery-icon">
        <view class="battery-head"></view>
        <view class="battery-body">
          <view class="battery-fill" style="width: {{battery}}%; background: {{batteryColor}}"></view>
          <!-- é—ªç”µå……ç”µåŠ¨ç”» -->
          <view class="charging-indicator" wx:if="{{isCharging}}">
            <view class="lightning"></view>
          </view>
        </view>
      </view>

      <!-- ç™¾åˆ†æ¯”æ˜¾ç¤º -->
      <view class="battery-percent-display">
        <text class="percent-number">{{battery}}</text>
        <text class="percent-symbol">%</text>
      </view>
    </view>

    <!-- çŠ¶æ€ä¿¡æ¯ -->
    <view class="battery-status-info">
      <text class="status-text">{{batteryText}}</text>
      <text class="estimate-time" wx:if="{{estimateTime}}">é¢„è®¡å¯ç”¨ {{estimateTime}}</text>
    </view>
  </view>

  <!-- ç”µé‡æ¶ˆè€—å¡ç‰‡ - ä»…åœ¨çº¿æ—¶æ˜¾ç¤º -->
  <view class="usage-card" wx:if="{{isOnline}}">
    <view class="usage-header">
      <text class="usage-title">ç”µé‡æ¶ˆè€—</text>
      <text class="usage-period">ä»Šæ—¥</text>
    </view>
    <view class="usage-list">
      <view class="usage-item">
        <view class="usage-item-left">
          <view class="usage-dot" style="background: #2196F3"></view>
          <text class="usage-name">GPSå®šä½</text>
        </view>
        <view class="usage-bar-container">
          <view class="usage-bar">
            <view class="usage-bar-fill blue" style="width: {{usageData.gps}}%"></view>
          </view>
          <text class="usage-percent">{{usageData.gps}}%</text>
        </view>
      </view>
      <view class="usage-item">
        <view class="usage-item-left">
          <view class="usage-dot" style="background: #FF9800"></view>
          <text class="usage-name">ä¼ æ„Ÿå™¨</text>
        </view>
        <view class="usage-bar-container">
          <view class="usage-bar">
            <view class="usage-bar-fill orange" style="width: {{usageData.sensor}}%"></view>
          </view>
          <text class="usage-percent">{{usageData.sensor}}%</text>
        </view>
      </view>
      <view class="usage-item">
        <view class="usage-item-left">
          <view class="usage-dot" style="background: #4CAF50"></view>
          <text class="usage-name">ç½‘ç»œé€šä¿¡</text>
        </view>
        <view class="usage-bar-container">
          <view class="usage-bar">
            <view class="usage-bar-fill green" style="width: {{usageData.network}}%"></view>
          </view>
          <text class="usage-percent">{{usageData.network}}%</text>
        </view>
      </view>
    </view>
  </view>

  <!-- ç”µæ± å¥åº·å¡ç‰‡ - ä»…åœ¨çº¿æ—¶æ˜¾ç¤º -->
  <view class="health-card" wx:if="{{isOnline}}">
    <view class="health-header">
      <view class="health-icon" style="background: #E8F5E9">
        <text class="icon-emoji">ğŸ’š</text>
      </view>
      <view class="health-info">
        <text class="health-title">ç”µæ± å¥åº·åº¦</text>
        <text class="health-value">{{healthStatus.text}} {{healthPercent}}%</text>
      </view>
    </view>
    <view class="health-bar">
      <view class="health-bar-fill" style="width: {{healthPercent}}%"></view>
    </view>
    <text class="health-tip">{{healthStatus.tip}}</text>
  </view>

  <!-- ç¦»çº¿æç¤º -->
  <view class="offline-tip" wx:if="{{!isOnline}}">
    <image class="tip-icon-img" src="/images/Not.png" mode="aspectFit"></image>
    <text class="tip-text">è®¾å¤‡ç¦»çº¿æ—¶æ— æ³•è·å–ç”µé‡æ•°æ®</text>
    <text class="tip-sub">è¯·ç¡®ä¿è®¾å¤‡åœ¨çº¿åæŸ¥çœ‹</text>
  </view>

  <!-- åº•éƒ¨é—´è· -->
  <view style="height: 40rpx"></view>
</view>
