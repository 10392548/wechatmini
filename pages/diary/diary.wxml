<!--pages/diary/diary.wxml-->
<navigation-bar title="æˆé•¿æ—¥å¿—" back="{{true}}" color="black" background="#FFF"></navigation-bar>

<view class="page-container">
  <!-- æ ‡ç­¾åˆ‡æ¢ -->
  <view class="tabs-wrapper">
    <view class="tabs-card">
      <view
        class="tab-item {{activeTab === 0 ? 'active' : ''}}"
        bindtap="onTabChange"
        data-index="0">
        <text class="tab-text">æ¯æ—¥å›é¡¾</text>
        <view class="tab-indicator" wx:if="{{activeTab === 0}}"></view>
      </view>
      <view
        class="tab-item {{activeTab === 1 ? 'active' : ''}}"
        bindtap="onTabChange"
        data-index="1">
        <text class="tab-text">å¥åº·æŠ¥å‘Š</text>
        <view class="tab-indicator" wx:if="{{activeTab === 1}}"></view>
      </view>
    </view>
  </view>

  <!-- å†…å®¹åŒºåŸŸ -->
  <scroll-view class="content-scroll" scroll-y show-scrollbar="{{false}}" bindrefresherrefresh="onRefresh" refresher-enabled="{{true}}" refresher-triggered="{{refreshing}}">
    <view class="content-inner">

      <!-- æ¯æ—¥å›é¡¾ -->
      <view class="logs-container" wx:if="{{activeTab === 0}}">
        <block wx:if="{{diaryList.length > 0}}">
          <view class="log-item" wx:for="{{diaryList}}" wx:key="id">
            <view class="log-left">
              <view class="log-time-column">
                <text class="log-time">{{item.time}}</text>
              </view>
            </view>
            <view class="log-card">
              <view class="log-icon-wrapper">
                <image class="log-icon" src="{{item.image}}" mode="aspectFit"></image>
              </view>
              <view class="log-content">
                <text class="log-title">{{item.title}}</text>
                <text class="log-desc" wx:if="{{item.description}}">{{item.description}}</text>
              </view>
            </view>
          </view>
        </block>

        <view class="empty-container" wx:if="{{diaryList.length === 0 && !loading}}">
          <text class="empty-emoji">ğŸ“</text>
          <text class="empty-title">è¿˜æ²¡æœ‰æˆé•¿è®°å½•</text>
          <text class="empty-desc">ç‚¹å‡»å³ä¸‹è§’æŒ‰é’®è®°å½•ç¬¬ä¸€ä¸ªç¬é—´</text>
        </view>
      </view>

      <!-- å¥åº·æŠ¥å‘Š -->
      <view class="health-container" wx:if="{{activeTab === 1}}">
        <block wx:if="{{healthRecords.length > 0}}">
          <view class="health-record-item" wx:for="{{healthRecords}}" wx:key="id">
            <view class="health-record-card">
              <view class="health-record-header">
                <view class="health-type-badge" style="background: {{item.typeColor}};">
                  <text class="type-icon">{{item.typeIcon}}</text>
                  <text class="type-name">{{item.typeName}}</text>
                </view>
                <text class="health-date">{{item.recordDate}}</text>
              </view>
              <text class="health-record-title">{{item.title}}</text>
              <view class="health-record-details" wx:if="{{item.details}}">
                <text class="detail-item" wx:for="{{item.details}}" wx:key="*">{{item}}</text>
              </view>
            </view>
          </view>
        </block>

        <view class="empty-container" wx:if="{{healthRecords.length === 0 && !loading}}">
          <image class="empty-image" src="/images/Health.png" mode="aspectFit"></image>
          <text class="empty-title">æš‚æ— å¥åº·è®°å½•</text>
          <text class="empty-desc">è®°å½•ç–«è‹—ã€ç”Ÿç—…ã€ç”¨è¯ç­‰å¥åº·ä¿¡æ¯</text>
        </view>

        <!-- å±…ä¸­æ·»åŠ æŒ‰é’® -->
        <view class="add-health-btn" bindtap="onAddHealthRecord">
          <text class="add-btn-icon">+</text>
          <text class="add-btn-text">æ·»åŠ å¥åº·è®°å½•</text>
        </view>
      </view>

    </view>
  </scroll-view>
</view>

<!-- æµ®åŠ¨åˆ›å»ºæŒ‰é’®ï¼ˆä»…åœ¨æ¯æ—¥å›é¡¾æ˜¾ç¤ºï¼‰ -->
<view class="fab" bindtap="onCreateLog" wx:if="{{activeTab === 0}}">
  <text class="fab-icon">+</text>
  <view class="fab-ring"></view>
</view>
